**Национална олимпиада по Информационни технологии – 2023/2024г.**

**Проект за разпознаване на изображения генерирани от изкуствен интелект – AI Photo Recognition**

1. **Тема на изработения проект:**

Разработване на система за разграничаване на изображения генерирани от изкуствен интелект от реални.

Регистрационен номер на проект: 464

1. **Автори на проекта:**

**-  Станислав Иванов Трендафилов**

ЕГН: 0550060447

Адрес: гр. Бургас ж.к. Изгрев бл.34

Телефон: +359 88 867 7008

Имейл: <sslav2005@gmail.com>

Училище: ППМГ “Акад. Никола Обрешков“ 12д клас

\-  **Кристиан Пламенов Петров**

ЕГН: 0546270546

Адрес: гр. Бургас ж.к. Възраждане ул. Хан Крум 37

Телефон: +359 89 781 0105

Имейл: <k_petrov27@abv.bg>

Училище: ППМГ “Акад. Никола Обрешков“ 12д клас

1. **Ръководител**

**- д-р Александър Димитров Иванов**

Телефон: 098 837 8335

Имейл: alex.ivanov@bfu.bg

Длъжност: старши учител по информатика и информационни технологии

1. **Тема на изработения проект:**

**4.1 Цели на проекта:**

Проектът има за цел изработката на софтуер, разпознаващ изображенията генерирани от изкуствен интелект.  Ползата от такова приложение е да се предотвратят злоупотреби с фалшиво съдържание, като например неправомерна употреба на нечий образ, разпознаване на фалшиви новини, предотвратяване на персонални атаки и други потенциални злоупотреби. Приложението може да осигури:

*Безопасност и сигурност:* Идентификацията на изображения, генерирани от ИИ, може да помогне в предотвратяването на злоупотреби със самоличност в социални мрежи, където се разпространяват съдържания, създадени от автоматизирани системи.

*Борба с дезинформацията:* Разпознаването на изображения, създадени от изкуствен интелект, може да подпомогне усилията за борба с фалшиви новини и дезинформация, които често използват генеративни модели за създаване на манипулативни съдържания.

*Потребителска прозрачност:* Предоставя информация и прозрачност за това, дали конкретно изображение е резултат на изкуствен интелект или е създадено от човек, което може да влияе на начина, по който потребителите взаимодействат със съдържанието. Приложението може да се използва в изясняването на авторски права върху дигитално съдържание.

*Контрол върху технологичното развитие:* Разпознаването на изображения, генерирани от ИИ, може да помогне в регулирането и контрола на технологичния напредък и усъвършенстването на алгоритмите за създаване на автоматизирани изображения.

Манипулацията на визуалната информация е голям проблем, пред който е изправено цялото общество. Разграничаването на синтетичните изображения от реалните (създадени от хора) става все по-важно, защото злоупотребите започват да стават все по-чести и шансът да разберем, че дадена снимка е изкуствено генерирана намалява с усъвършенстване на генеративните технологии. В наши дни снимките, генерирани от изкуствен интелект, стават все по-често срещани и присъстват във все повече дигитални платформи. В библиотеките със стокови изображения, достъпни с лиценз, става все по-важно да се определи дали дадено изображение е генерирано от изкуствен интелект, главно защото тяхната правна основа е различна от традиционните, създадени от човека.** Когато потребителите използват генеративни технологии с изкуствен интелект, за да манипулират образа на човек от реалния живот резултатът може да бъде реалистичен и правдоподобен. В случаите, в които създателят  не изясни, че това изображение е изкуствено създадено може да възникнат много проблеми. Ако потребителите не внимават може да попаднат на дезинформация и фалшиви събития. Освен това, много хора поставят под въпрос законността на синтетичните медии, тъй като те са технически изградени от „битове“, от работата на други (човешки) художници, често без разрешение или компенсация. Към този момент нито един инструмент за генериране на изкуствени изображения не може да гарантира правната валидност на изображенията, създадени с него и че никоя от страните не притежава авторските права върху споменатите изображения. Докато генерираните от изкуствен интелект снимки са забавни за създаване и визуално въздействащи, някои генератори на изображения с изкуствен произход са по-безопасни и етично по-справедливи от други. Всичко това създава необходимост да се знае кога изображение, което виждаме, е генерирано по изкуствен начин и какви са правата върху това изображение, ако решим да го използваме.

В процеса на проучване не успяхме да открием софтуер, който успява да разпознава снимките създадени от изкуствен интелект и да бъде лицензиран по някакъв начин.

**4.2. Основни етапи в реализирането на проекта (основни дейности, роли на авторите)**

Основните етапи при изготвяне на настоящият проект са следните:

1) Проучване на съществуващи решения и релевантни технологии
1) Логическо проектиране на бъдещата система, избор на технологии и разпределяне на задачи
1) Снабдяване с необходимите данни за обучение на модела (конволюционна невронна мрежа)
1) Обучение на модела с данните и тестване на обучението
1) Изграждане на потребителския интерфейс
1) Интегриране на потребителския интерфейс с обучения модел
1) Изготвяне на документация


**4.3. Ниво на сложност на проекта − основни проблеми при реализация на поставените цели**

Реализирането на проекта изисква познаване на съвременните технологии за машинно обучение (machine learning), намиране и обработка на данни, необходими за обучението, избор на подходящи настройки на обучението на модела, тестове с разнообразно съдържание, изграждане на адаптивен (responsive) и лесен за работа (user-friendly) интерфейс. Това характеризира проекта като средно високо ниво на сложност.

4. **Логическо и функционално описание на решението – архитектура, от какви модули е изградено, какви са функциите на всеки модул, какви са взаимодействията помежду им и т.н.**

   1. **Използван набор от данни за обучението** 

` `За обучението на модела, разпознаващ изображения на обекти е използван готов набор от данни, съдържащ 120 000 снимки, разделени на 2 класа - такива генерирани от ИИ и такива, които не са. Изображенията са с резолюция 32 на 32 пиксела и са във формат PNG. За обучението са използвани по-малка част от тези снимки в съотношение 7:3 данни за обучение към данни за тест. Линк към данните: <https://www.kaggle.com/datasets/birdy654/cifake-real-and-ai-generated-synthetic-images>. 

За обучението на  модела, който разпознава лица е използван готов набор от данни, съдържащи 140 000 снимки, разделени в 2 основни класа: създадени от ИИ и такива, които са реални. Изображенията са с резолюция 256 на 256 пиксела и са във формат JPG. За обучението са използвани 120 000 от тези снимки в съотношение 5:1 данни за обучение към данни за тест. Линк към данните:

<https://www.kaggle.com/datasets/xhlulu/140k-real-and-fake-faces>

**4.4.2 Програмиране и обучение на невронния модел:**

За създаването на алгоритъма за разпознаване на генерирани снимки е използвана конволюционна невронна мрежа (Convolutional Neural Network, CNN). CNN е основната технология в обработката на изображения и разпознаването на обекти. Ето основните стъпки, които са включени в кода: 

\- Дефиниране на архитектурата на модела: Използва се методът keras.Sequential, който изгражда последователност от слоеве в невронната мрежа. В архитектурата са използвани няколко конволюционни слоя (Conv2D) за извличане на характеристики от изображенията, сливащи слоеве (MaxPooling2D) за намаляване на размерността, слоеве на изравняване (Flatten) и напълно свързани слоеве (Dense) за финалната класификация. 

![Картина, която съдържа текст, екранна снимка, Шрифт

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.001.png)

\- Компилиране на модела: За компилацията на модела са използвани оптимизатора "adam" и функцията на грешката двоична кросентропия "binary\_crossentropy", тъй като моделът се обучава да класифицира изображенията в две категории (генерирани изображения и реални снимки). Освен това, използвана е и метриката точност ("accuracy") за оценка на точността на модела.

![](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.002.png)

![Картина, която съдържа текст, екранна снимка, софтуер, Мултимедиен софтуер

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.003.png)- Зареждане на данните за обучение и валидационни данни: Използвана е функцията keras.preprocessing.image\_dataset\_from\_directory, за зареждане на данните от съответните директории. Това предоставя удобен начин за работа с данните и предварителна обработка като изменение на размера на изображенията. 







\- Обучение на модела: Извършено обучение на модела, като е използвана функцията "fit" в TensorFlow. Прехвърлени са данните за обучение и валидацията, които предварително бяха заредени, с посочен брой на епохите за обучение (10). Моделът бе обучен чрез оптимизация на функцията на грешката и мерки за оценка.

![](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.004.png)

\- Обучението протича в 10 отделни епохи като с всяка следваща се подобрява точността на обучаващия се модел (accuracy) и се намалят загубите (loss), което предсталява функция на грешката, определяща разликата между предположените стойности (predicted output) на алгоритъма за обучение на модела и реалните целеви стойности (actual target values).

![Картина, която съдържа текст, екранна снимка, Шрифт, меню

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.005.png)			

**4.4.3 Интегриране на обучения модел в уеб**

Flask уеб приложението използва модели за дълбоко обучение за класификация на изображения. Има два основни пътя (/upload\_human и /upload\_object) за качване на човешки и обектни изображения съответно. Приложението класифицира тези изображения с помощта на предварително обучени модели и показва резултатите на съответните HTML страници. Чрез променливата UPLOAD\_FOLDER се задава пътя, където се съхраняват качените изображения.

![A screen shot of a computer screen

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.006.png)

\- Обработка на изображения от модела за разпознаване на изкуствено генерирани хора: 

Методът Post има за цел да приема качено изображение на човек. Изображението се обработва, като се преоразмерява до (224, 224) като се извършват различни трансформации и снимкате се конвертира в torch.Tensor. След това се прави предположение за произхода на транформираната снимка и показва резултата на шаблона human\_model\_page.html.

![A computer screen shot of a program

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.007.png)

\- Обработка на изображения от модела за разпознаване на изкуствено генерирани обекти: Методът Post приема каченото изображение на обект. Обработва се изображението за object\_model. Зарежда изображението и го преоразмерява до (256, 256), конвертирайки го в NumPy масив.. Прави прогнози с помощта на обучения модел (object\_model). След обработка показва резултата на шаблона object\_model\_page.html. 

`	`**4.4.4 Изработка на адаптивен и лесен за работа интерфейс**

\- Начална страница (Home). Състои се от header, който навигира между отделните страници. Основната част, която представлява кратка информация за проекта и нуждата от това да има софтуер, разпознаващ изкуствено генерирани изображения. Разработена е секция с кратки въпроси и отговори на тема изображения, генерирани от ИИ,

![A screenshot of a computer

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.008.png)

![Картина, която съдържа текст, екранна снимка, Уебсайт, Уеб страница

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.009.png)

\- Страница за услуги (Services). Съдържа два панела като единият препраща към модела, който разпознава изображенията генерирани от ИИ, а другият препраща към модела, който е обучен да разпознава обектите, създадени от генеративни технологии. Третият панел представя функционалност, която предстои да бъде реализирана.

![A screenshot of a website

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.010.png)

\- Страница на предимствата, които осигурява нашия софтуер (Why us). 

![Картина, която съдържа текст, екранна снимка, Шрифт

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.011.png)

![Картина, която съдържа текст, екранна снимка, Шрифт, софтуер

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.012.png)

\- Страница, която представя отбора, изготвил проекта.

![A screenshot of a computer

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.013.png)

\- Изработеното приложение е с адаптивен интерфейс (responsive). 

![Картина, която съдържа текст, електроника, екранна снимка, софтуер

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.014.png)![Картина, която съдържа текст, екранна снимка, Човешко лице, човек

Описанието е генерирано автоматично](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.015.png)

**4.5. Реализация − обосновка за използвани технологични средства, алгоритми, литература, програмни приложения и др.** 

За представителната част са използвани стандартни технологии **–** HTML 5, CSS 3, JavaScript и Flask за интегриране на моделите в уеб.

За създаване и обучение на модел е използвана Python библиотеката TensorFlow, която предоставя модели за невронни мрежи. Избрана е технологията конволюционна невронна мрежа, която е state-of-the-art решение за компютърно зрение. Използвани са и помощни библиотеки на същия език за обработка и прочит на изображения, както и тестване на машинното обучение.

**4.6. Описание на приложението – как се стартира и/или инсталира, как се използва, как се поддържа** 

Проектът е реализиран като уеб приложение, разработено чрез Python фреймуърка Flask. 

*Зависимости (Dependencies):* 

Необходимо е всички Python пакети да са инсталирани. Може да се инсталират с помощта на следната команда: **pip install Flask tensorflow keras Pillow**

*Конфигурация:*

Трябва да се зададе променливата UPLOAD\_FOLDER на пътя, където се съхраняват качените изображения.

*Стартиране на приложението:*

За да се стартира Flask приложението, трябва в терминала да се напише следната команда:

**python app.py**

Това ще стартира уеб сървър, а приложението ще бъде достъпно на <http://127.0.0.1:5000/>.

Налични са следните страници, които реализират основната функционалност на нашето приложение:

\- При отваряне на страницата на модела за разпознаване на синтетично създадени обекти излиза прозорец, който трябва да бъде натиснат за избор на изображение.

![A screenshot of a computer

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.016.png)

\- Избираме изображение на котка, генерирано от ИИ

![A screenshot of a computer

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.017.png)

\- След натискане на бутона за качване (Upload) получаваме отговор за произхода на прикачената снимка. При натискане на бутона за изчистване (Clear) снимката се зачиства и се връщаме в предишното положение (скрийншотът прикачен по-горе). 

![A screen shot of a computer

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.018.png)

\- При избиране на страницата на модела за разпознаване на човешки изображения е налице същата функционалност.

![A screenshot of a person

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.019.png)

![A screen shot of a camera

Description automatically generated](Aspose.Words.bfd5af8d-8394-4e64-af51-bdba104cb258.020.png)

**4.7. Заключение**

Настоящият проект успешно реализира уеб приложение с интегриран обучен невронен модел за разпознаване на съдържание, генерирано от ИИ и реални снимки. Проектът е работещ, като към момента е постигната точност от над 96% при проведени тестове. Предвид непрекъснатото подобряване на генеративните модели, се очаква моделът да бъде периодично дообучаван за съгласуване на качеството на разпознаване с качеството на генеративното съдържание. Също така бъдещата реализация на проекта би включвала множество подобрения като:

- Увеличаване на разнообразието от данни за обучение – Добавяне на по разнообразни обеми от данни за обучение с цел разширяване на използваемостта в различни сфери. 
- Подобряваняне на точността на текущите модели - Интегриране на различни модели и алгоритми за по-добра прецизност при разпознаването. Работа върху оптимизацията на алгоритмите за по-бързо и по-ефективно разпознаване.
- Внедряване на разпознаването на изображения в реално време - Развитие на системата, с което ще може да работи в реално време за незабавно разпознаване на генерирани изображения.
- Разпознаване на процент от изображението, генерирано от изкуствен интелект – Изследва изображението и проверява каква част от него е изкуствено генерирана.


  **Линк към GitHub: https://github.com/Kristian2705/AI-Photo-Recognition**

  **Използвани източници:**

\* <https://www.fotor.com/features/ai-image-generator/>

\* <https://freeimagegenerator.com/?aiPrompt=forest&currentPage=1&numPerPage=12>

\* <https://stackoverflow.com/>

\* <https://www.tensorflow.org/>

\* <https://github.com/keras-team/keras>

\* <https://deepai.org/machine-learning-model/text2img>

` `\* Kirill Vishniakov and Zhiqiang Shen and Zhuang Liu, ConvNet vs Transformer, Supervised vs CLIP: Beyond ImageNet Accuracy, aXiv, 2024




